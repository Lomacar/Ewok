const Ewok={dependencies:[],classes:{},sharedModules:{},init(e,t="template"){plates=document.querySelectorAll(t);let n=[...plates].map((e=>e.id)).filter((e=>e)).join(","),o=new Set([...document.querySelectorAll(n)].map((e=>e.tagName.toLowerCase()))),s=[...document.querySelectorAll(t)].filter((e=>e.hasAttribute("extends"))).map((e=>`[is=${e.id}]`)).join(",");if(s){let e=new Set([...document.querySelectorAll(s)].map((e=>e.getAttribute("is"))));e.size&&(o=new Set([...o,...e]))}o.forEach((e=>{let t=document.getElementById(e).content,s=new Set([...t.querySelectorAll(n)].map((e=>e.tagName.toLowerCase())));s.size&&s.forEach((t=>{Ewok.dependencies.push([t,e]),o.add(t)}))}));let i=new function(e,t){const n=this.adjacencyList=new Map,o=this.independentNodes=new Set(e);this.nodes=e,this.addNode=function(e){n.set(e,new Set)},this.addEdge=function(e,t){try{return n.get(e).add(t),!0}catch(e){return console.warn("Invalid edge."),!1}},e&&e.length&&(e.forEach(this.addNode),t&&t.length&&t.forEach((e=>{this.addEdge(...e)&&o.delete(e[1])})));return this}([...o],Ewok.dependencies);function r(e,t,n=""){return"$"==e[0]&&(t=window,e=e.slice(1)),e.split(".").reduce(((e,t)=>("function"==typeof e[t]?e[t]():e[t])||n),t)}o=function(e){const t=[],n={};for(const t of e.nodes)for(neighbor of e.adjacencyList.get(t))n[neighbor]=n[neighbor]+1||1;let o=0,s=new Set(e.independentNodes);for(;s.size;){let i=s.values().next().value;s.delete(i),t.push(i),o++,e.adjacencyList.get(i).forEach((e=>{n[e]--,0===n[e]&&s.add(e)}))}o!==e.nodes.length&&console.warn("Dependecy cycle detected.");return t}(i),o.forEach((t=>{!function(e,t){const n=document.getElementById(e),o=n.content,s=new Map(Object.entries([...n.attributes].filter((e=>"id"!=e.name)).reduce(((e,t)=>(e[t.name]=t.value,n.removeAttribute(t.name),e)),{})));let i,l,c=[],a=o.querySelectorAll("script");a.length&&(i=[...a].filter((e=>e.hasAttribute("shared"))),l=[...a].filter((e=>!e.hasAttribute("shared"))),i=i.reduce(((e,t)=>e+t.text),""),l=l.reduce(((e,t)=>e+t.text),""),i&&d(i,!0),a.forEach((e=>e.remove())));function d(e,t=!1){let n=new Blob([(t?"":"let host; export function ewokAttachHost(){host = this};\n                ")+e],{type:"application/javascript"});c[1+t]=import(URL.createObjectURL(n)),URL.revokeObjectURL(n)}const h=s.get("extends");let u;if(h){const e=()=>{return e=`${h} is not a valid element to extend.`,void console.warn("ðŸ™ˆ Ewok: "+e);var e};try{const e=document.createElement(h);if(e.__proto__==HTMLUnknownElement.prototype)throw"invalid element type";u=e.__proto__.constructor}catch{e(),h=null}}Ewok.classes[e]=class extends(u||HTMLElement){constructor(){super(),this.hasAttribute("noshadow")||this.attachShadow({mode:"open"}),this.hasAttribute("x-data")&&Alpine.initTree(this)}connectedCallback(){let n=new Event("connecting",{node:this});this.dispatchEvent(n),this.setAttribute("loading","");let i=this.shadowRoot||this,a=this.parentElement||this.getRootNode().host,h=a.hasOwnProperty("props");for(const e of s)this.hasAttribute(e[0])||this.setAttribute(e[0],e[1]);let u=o.cloneNode(!0),p=u.querySelector("[temp]");p=this.querySelector("[temp]")||p,p&&i.appendChild(p),u.querySelectorAll("*").forEach((e=>{e.host=this}));let m=this;this.propsReady=new Promise((function(e,t){m.resolver=e,m.rejecter=t}));let w=h?a.propsReady:null;function f(e,t){[...e.children].forEach((e=>{if("SCRIPT"!=e.nodeName&&!Object.keys(Ewok.classes).includes(e.tagName.toLowerCase())){let n=e.innerHTML;n&&n.includes("{{")&&(e.innerHTML=function(e,t,n){const o=/\{\{[^{<"']+}}/g;return e.replace(o,(e=>{const n=e.slice(2,-2).split("|");return r(n[0].trim(),t,n[1])}))}(n,t)),n&&n.includes("{*")&&(e.innerHTML=e.innerHTML.replace(/(\{\**)\*(\{)(.*)(\}\**)\*(\})/g,"$1$2$3$4$5"))}}))}function E(){if(this.shadowRoot&&t?.stylesheet){let e=document.createElement("link");e.setAttribute("rel","stylesheet"),e.setAttribute("href",t.stylesheet),this.shadowRoot.appendChild(e)}i.appendChild(u),p&&i.querySelectorAll("[temp]").forEach((e=>e.remove()))}function y(){this.shadowRoot&&this.closest("[x-data]")&&Alpine.initTree(this.shadowRoot)}c[0]=w,l&&d(l),Promise.all(c).then((t=>{let n=t[1],o=t[2],s={...o,...n};o&&(Ewok.sharedModules[e]=o);let i=h?a.props:null,l={...this.dataset};for(let e in l){let t=l[e];if("$"==t[0]){let n=t.slice(1);t.includes(".")?l[e]=r(n,window):l[e]=window[n]}}this.props={...i,...s,...l},this.resolver(),n&&n.ewokAttachHost.apply(this),f(u,this.props),this.shadowRoot&&f(this,this.props),u.querySelectorAll("*").forEach((e=>{e.props=this.props})),E.apply(this),this.removeAttribute("loading"),s&&s.mount&&s.mount.apply(this,null),y.apply(this)})),n=new Event("connected",{detail:e}),n.elem=e,window.dispatchEvent(n)}},customElements.define(e,Ewok.classes[e],h&&{extends:h})}(t,e)}))}};class EwokImportContent extends HTMLElement{constructor(){super()}get path(){return this.getAttribute("src")||""}get loading(){return this.getAttribute("loading")||"auto"}connectedCallback(){this.innerHTML=`\n        <iframe src="${this.path}" loading="${this.loading}" hidden></iframe>\n    `;const e=this.querySelector("iframe");e.addEventListener("load",(t=>{[...e.contentDocument.children].forEach((t=>e.before(t))),e.remove()}))}}"customElements"in window&&customElements.define("ewok-import",EwokImportContent),window.onload=function(){Ewok.init()};